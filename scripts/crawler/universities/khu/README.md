# 경희대학교 크롤러 (KHU Crawler)

## 데이터 소스

경희대학교 수강신청 시스템의 `data.js` 파일에서 메타데이터를 추출합니다.

- **URL**: `https://sugang.khu.ac.kr/core?attribute=coreMain&fake={timestamp}`
- **형식**: JavaScript 변수 선언 (`var varname = {...}`)

## 크롤링 워크플로우

```
┌──────────────────────────────────────────────────────────┐
│ 1. metadata 크롤링                                       │
│    data.js → colleges, departments, courseTypes 추출    │
└──────────────────────────────────────────────────────────┘
                           ↓
┌──────────────────────────────────────────────────────────┐
│ 2. courses 크롤링 (학과별)                               │
│    for each department:                                  │
│      → API 호출 (major_code=A00430)                     │
│      → 각 course에 _queried_dept 주입                   │
└──────────────────────────────────────────────────────────┘
                           ↓
┌──────────────────────────────────────────────────────────┐
│ 3. transform (중복 병합)                                 │
│    동일 강의가 여러 학과에서 조회되면:                    │
│      → departmentCodes 배열로 병합                      │
│    예: ["A10627", "A07337"] (컴공 + 소융)               │
└──────────────────────────────────────────────────────────┘
```

### 왜 학과별로 조회하나?

경희대 API의 `class_cd` 필드는 **개설 학과**만 반환하고, **수강 가능 학과**는 반환하지 않습니다.
예: 소프트웨어융합학과 강의가 컴퓨터공학과에서도 수강 가능해도, API는 `class_cd: A07337` (소융)만 반환.

따라서 **학과별로 조회**하여 해당 학과에서 보이는 강의 = 해당 학과 학생이 수강 가능한 강의로 해석하고,
`_queried_dept` 필드에 조회한 학과 코드를 주입합니다.


## Raw Data 필드 명세

> ⚠️ 공식 API 문서가 없어 실제 데이터에서 역분석한 내용입니다.

### `daehak_YYYYMM` (단과대학)

단과대학/대학원 목록입니다.

| 필드 | 설명 | 예시 |
|------|------|------|
| `id` | 순번 | `1` |
| `nm` | 국문명 | `"문과대학"` |
| `enm` | 영문명 | `"College of Humanities"` |
| `cd` | **단과대학 코드** ⭐ | `"A01008"` |
| `or_seq` | 정렬 순서 | `"10"` |
| `up` | 상위 조직 코드 | `"A10081"` |
| `gb` | 구분 | `"H"` (학부), `"D"` (대학원) |

### `major_YYYYMM` (학과/전공)

학과 및 전공 목록입니다.

| 필드 | 설명 | 예시 |
|------|------|------|
| `id` | 순번 | `1` |
| `nm` | 국문명 | `"정경대학 경제학과 경제학"` |
| `enm` | 영문명 | `"College of Politics & Economics..."` |
| `cd` | **학과 코드** ⭐ | `"A00430"` |
| `dh` | **소속 단과대학 코드** ⭐ | `"A00422"` |
| `orgnz_lvl_se_code` | 조직 레벨 | `"11"` (단과대), `"20"` (학부), `"30"` (학과) |
| `orgnz_outpt_ord` | 정렬 순서 | `"10"` |
| `gb` | 구분 | `"H"` (학부), `"D"` (대학원) |

> 💡 `dh`는 "대학(daehak)"의 약어로, 해당 학과가 속한 단과대학의 코드를 가리킵니다.

### `gradIsuCd_YYYY` (이수구분)

교과목 이수구분 코드입니다.

| 필드 | 설명 | 예시 |
|------|------|------|
| `id` | 순번 | `1` |
| `nmk` | 국문명 | `"전공필수"` |
| `nme` | 영문명 | `"Essential Major Studies"` |
| `cd` | **이수구분 코드** ⭐ | `"04"` |

주요 이수구분 코드:
- `04` - 전공필수
- `05` - 전공선택
- `06` - 교직
- `11` - 전공기초

### 강의 API 응답 (courses)

`/core?attribute=lectListJson` 엔드포인트에서 반환되는 강의 데이터입니다.

| 필드 | 설명 | 예시 |
|------|------|------|
| `subjt_cd` | 교과목 코드 | `"CSE302"` |
| `subjt_name` | 교과목명 | `"컴퓨터네트워크"` |
| `lecture_cd_disp` | 강의코드-분반 | `"CSE302-01"` |
| `teach_na` | 담당교수 | `"홍길동"` |
| `unit_num` | 학점 | `"3"` |
| `lect_grade` | 대상학년 | `"3"` |
| `timetable` | 시간표 | `"화 15:00-16:15 (전211-1)<BR>목..."` |
| `field_gb` | 이수구분 코드 | `"04"` |
| `class_cd` | 학과 코드 | `"A10627"` |
| `campus_nm` | 캠퍼스 | `"국제"` |
| `bigo` | 비고 | `""` |

## 파일 구조

```
universities/khu/
├── README.md      # 이 문서
├── config.py      # 상수 및 URL 설정
├── crawler.py     # HTTP 요청 및 데이터 수집
└── parser.py      # 데이터 파싱 및 변환
```
